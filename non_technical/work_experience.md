# 工作经验 Work Experience 

自我介绍：
- 孙博剑，罗马大学
- 意大利华为 2年多 2b的业务，数字化转型，报表开发。疫情后回国。
- 拼多多
  - 国内电商业务dw 核心报表开发运维，数据服务开发，模型层开发，模型运维优化，数据质量监控体系。
  - 国内体系比较完善，主要是运维和迭代。
  - temu 10月 供应链 物流域 owner 从包裹打包到签收的业务过程。 仓域包裹生成到包裹打包仓内流程。
  - 核心报表业务 for 高层（冬枣赵佳臻，阿布顾pingping）roi,gmv等指标报表 ，取数分析(根据业务提供的一些变化，帮助老板预估变化做决策)
  - 早期从ods直接上，现在逐渐切换至cdm的表，不直接使用ods(切库很麻烦)合规改造，指标口径变化，数据质量的保证。
  - 有一些报表使用的lambda架构，实时的 rdm层(不包括 cdm) 运维优化改造提高稳定性等

## ![#f03c15](https://placehold.it/15/f03c15/000000?text=+) `pdd Temu`

### ![#1589F0](https://placehold.it/15/1589F0/000000?text=+) `ROI报表`

- abu coo，冬枣等高管的需求，粒度：支付日期，类目，团队，商品，运营等。考评和决策
- 成本数据调研，物流结算系统，商家供货系统，境内仓库结算系统（系统，还有海外），客服结算（海外外包），积分系统，退款系统
  - 物流真实费用的分摊，敏感品，体积重等。预估费用，历史，国家，比例，最近N天，sku，商品，类目等。
  - 客服按国家来分摊，仓库按订单。积分按用户来分摊。退款按关联订单等。
  - 成本是不断添加的，根据业务发展，老板来定。墨西哥盗抢售后多。
- 收入数据，实付去税，特殊优惠（新人，引流啥的另算），补进GMV和消耗预算逻辑不一样
- 离线全量数据，迭代需要，hive表，模型层加了审批限制。
- 一系列不同粒度报表。
  - 高管看粗粒度mysql，稳定性高，限制5秒能查出来。
  - 运营业务人员看戏粒度presto，共享集群稳定性较差，优点可以存数据比较多。

### ![#1589F0](https://placehold.it/15/1589F0/000000?text=+) `物流域CDM模型开发`

- 数仓贴源（ods归属），业务组（不同域数据owner），核心指标口径定义维护
- 业务过程->声明粒度->确定维度->确定事实
  - 业务开发，产品调研 业务 字段含义等
  - 业务BI调研需求
  - 确认过程，数据探查，字段含义
  - 评审，开发上线，数据质量保障
  - 优化和迭代，基线保障
- 数据探查，cdm（dwd，dwb，dws，hds_b和hds_a)

### ![#1589F0](https://placehold.it/15/1589F0/000000?text=+) `交易核心指标报表`

- lambda 架构, MySQL 优先展示实时其次离线
- 业务口径和指标 根据老板需求定义的，根据业务调整不断更新
- 离线
  - 1h和dth增量，事实数据增量开发，口径大变=》回刷历史
  - hive中开发，rdm表
  - 口径已经沉淀到cdm，推广全公司使用
  - 维护了一些维表给离线实时使用
- 实时
  - kafka topic
  - datastream 纯流式无窗口，5s中下发一次 state保存25小时
  - 稳定性优化和配置化改造 主备多套代码到一套
- dqc，主备，实时离线，上下游一致性，跨源一致性，指标值合理性（非零，范围，比什么大比什么小）

### ![#1589F0](https://placehold.it/15/1589F0/000000?text=+) `top2000商品报表`

- lambda 架构
- 现状使用druid
  - 实时topic写入druid明细
  - 离线导入覆盖
  - 21年10月，每天1.5亿+，差异大，近似分片计算
- 优化方案使用clickhouse，指标准，排名近似
  - 近似算法，2w-10w 商品用于过滤
  - flink写入clickhouse replacing mergetree引擎
  - 实时算top2w写入（keyby goods，keyby 日期，优先级队列 小顶堆）
  - 30天近百亿10s左右可以查出来，指标百分百准确。1950是准的，1%不准。

## ![#f03c15](https://placehold.it/15/f03c15/000000?text=+) `HW(Netcom Altran)`

### ![#1589F0](https://placehold.it/15/1589F0/000000?text=+) `项目管理报表`
